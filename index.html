(() => {
    if (document.cookie.includes("sidebarRemoved=true")) {
        let burger = document.getElementById("openSidebar");
        if (burger) burger.remove();
    } else {
        let e = document.createElement("div");
        e.id = "custom-sidebar";
        e.style.position = "fixed";
        e.style.width = "250px";
        e.style.height = "100vh";
        e.style.padding = "15px";
        e.style.boxShadow = "2px 0 5px rgba(0,0,0,0.5)";
        e.style.transition = "transform 0.5s ease-in-out";
        e.style.zIndex = "1000";
        e.style.background = localStorage.getItem("bgColor") || "#d9eafd";
        e.style.color = localStorage.getItem("textColor") || "#333";
        e.style.left = "-270px";
        e.style.display = "flex";
        e.style.flexDirection = "column";
        e.style.justifyContent = "space-between";
        console.log("Sidebar script loaded");

        e.innerHTML = `
            <div>
                <button id="toggleSidebar" style="position: absolute; top: 10px; right: 10px; background: transparent; border: none; font-size: 24px; cursor: pointer;">‚úñ</button>
                <h2>üìÇ Menu</h2>
                <ul>
                    <li><a href="https://bonosa.github.io/sidebar_public/index.html">üè† Home</a></li>
                    <li><a href="https://bonosa.github.io/sidebar_public/dashboard.html">‚öôÔ∏è Customize Sidebar</a></li>
                    <li><a href="https://bonosa.github.io/sidebar_public/faq.html">‚ùì Troubleshoot & FAQ</a></li>
                    <li><a href="mailto:sbono@gmail.com">üìß Contact</a></li>
                </ul>
            </div>
            <div style="margin-top: auto; text-align: center; font-size: 14px;">
                <a href="#" id="uninstallSidebar" style="color: red; text-decoration: none;">‚ùå Uninstall Sidebar</a>
            </div>
        `;

        document.body.appendChild(e);

        document.getElementById("uninstallSidebar").addEventListener("click", function () {
            document.cookie = "sidebarRemoved=true; path=/; expires=Fri, 31 Dec 9999 23:59:59 GMT";
            alert("Sidebar uninstalled. Refresh the page to apply changes.");
            e.remove();
            let t = document.getElementById("openSidebar");
            if (t) t.remove();
        });

        document.getElementById("toggleSidebar").addEventListener("click", function () {
            e.style.transform = "translateX(" + ("-270px" === e.style.left ? "0" : "-270px") + ")";
        });

        // ‚úÖ Ensure the Burger Always Exists
        function createBurger() {
            let existingBurger = document.getElementById("openSidebar");
            if (!existingBurger) {
                let burger = document.createElement("button");
                burger.id = "openSidebar";
                burger.textContent = "‚ò∞";
                burger.style.position = "fixed";
                burger.style.top = "15px";
                burger.style.left = "15px";
                burger.style.fontSize = "30px";
                burger.style.background = "transparent";
                burger.style.border = "none";
                burger.style.color = "black";
                burger.style.cursor = "pointer";
                burger.onclick = function () {
                    e.style.transform = "translateX(0)";
                };
                document.body.appendChild(burger);
            }
        }

        createBurger(); // Call this function to ensure the burger exists on page load
    }
})();
